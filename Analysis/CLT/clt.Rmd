---
title: "CLT"
author: "Martín Ramírez Espinosa & Sergio Alejandro González Osorio"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Simulación del Teorema del Límite Central

Para que la convergencia sea evidente partimos de una distribución exponencial, la cual es muy sesgada. Después tomamos muchas muestras aleatorias del mismo tamaño, calculamos su promedio y vamos dibujando histogramas de esos promedios a medida que aumenta el tamaño muestral.

```{r clt-simulation}
rate <- 1/3
gen_sample <- function(n) rexp(n, rate = rate)

# La distribución original es asimétrica
population_sample <- gen_sample(10000)
hist(
  population_sample,
  breaks = 40,
  col = "#F0E442",
  border = "white",
  main = "Distribución exponencial sesgada",
  xlab = "Valor observado",
  freq = FALSE
)

# Histogramas para los promedios muestrales
sample_sizes <- c(1, 2, 5, 10, 30, 80)
simulations <- 4000
mu <- 1 / rate
sigma <- 1 / rate
par(mfrow = c(3, 2), mar = c(4, 4, 2, 1))
for (n in sample_sizes) {
  sample_means <- replicate(simulations, mean(gen_sample(n)))
  hist(
    sample_means,
    breaks = 30,
    freq = FALSE,
    col = "#56B4E9",
    border = "white",
    main = paste("Promedios muestrales con n =", n),
    xlab = "Promedio"
  )
  curve(dnorm(x, mean = mu, sd = sigma / sqrt(n)), add = TRUE, col = "#D55E00", lwd = 2)
}
par(mfrow = c(1, 1))
```
